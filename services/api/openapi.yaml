openapi: 3.1.0
info:
  title: DrugInsightAI API
  description: |
    REST API service for the DrugInsightAI pharmaceutical data analysis platform.

    This API provides endpoints for:
    - Drug information and analytics
    - Clinical trial data
    - Pharmaceutical company insights
    - Market analysis
    - User management and authentication

  version: 0.1.0
  contact:
    name: DrugInsightAI Team
    email: support@druginsightai.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:8000
    description: Development server
  - url: https://api.druginsightai.com
    description: Production server

security:
  - BearerAuth: []
  - ApiKeyAuth: []

paths:
  # Health and Status
  /health:
    get:
      tags:
        - Health
      summary: Health check endpoint
      description: Returns the current health status of the API service
      operationId: get_health_status
      security: []
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthStatus'

  /metrics:
    get:
      tags:
        - Health
      summary: Get API metrics
      description: Returns current API performance and usage metrics
      operationId: get_metrics
      responses:
        '200':
          description: API metrics retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiMetrics'

  # Authentication
  /auth/login:
    post:
      tags:
        - Authentication
      summary: User login
      description: Authenticate user and return access token
      operationId: login_user
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/refresh:
    post:
      tags:
        - Authentication
      summary: Refresh access token
      description: Get a new access token using refresh token
      operationId: refresh_token
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshTokenRequest'
      responses:
        '200':
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        '401':
          description: Invalid refresh token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Users
  /users/profile:
    get:
      tags:
        - Users
      summary: Get current user profile
      description: Returns the profile information of the authenticated user
      operationId: get_current_user_profile
      responses:
        '200':
          description: User profile retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfile'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    patch:
      tags:
        - Users
      summary: Update user profile
      description: Update the authenticated user's profile information
      operationId: update_user_profile
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserProfileUpdate'
      responses:
        '200':
          description: Profile updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfile'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Drugs
  /drugs:
    get:
      tags:
        - Drugs
      summary: List drugs
      description: Get a paginated list of drugs with optional filtering
      operationId: list_drugs
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page
          required: false
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
        - name: search
          in: query
          description: Search term for drug names or descriptions
          required: false
          schema:
            type: string
        - name: therapeutic_area
          in: query
          description: Filter by therapeutic area
          required: false
          schema:
            type: string
        - name: company
          in: query
          description: Filter by pharmaceutical company
          required: false
          schema:
            type: string
        - name: status
          in: query
          description: Filter by drug development status
          required: false
          schema:
            $ref: '#/components/schemas/DrugStatus'
      responses:
        '200':
          description: Drugs retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DrugListResponse'

  /drugs/{drug_id}:
    get:
      tags:
        - Drugs
      summary: Get drug details
      description: Get detailed information about a specific drug
      operationId: get_drug_details
      parameters:
        - name: drug_id
          in: path
          required: true
          description: Unique identifier for the drug
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Drug details retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DrugDetails'
        '404':
          description: Drug not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /drugs/{drug_id}/analytics:
    get:
      tags:
        - Drugs
      summary: Get drug analytics
      description: Get analytical insights and metrics for a specific drug
      operationId: get_drug_analytics
      parameters:
        - name: drug_id
          in: path
          required: true
          description: Unique identifier for the drug
          schema:
            type: string
            format: uuid
        - name: time_period
          in: query
          description: Time period for analytics data
          required: false
          schema:
            type: string
            enum: [1m, 3m, 6m, 1y, all]
            default: 6m
      responses:
        '200':
          description: Drug analytics retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DrugAnalytics'

  /drugs/{drug_id}/adverse-events:
    get:
      tags:
        - Drugs
      summary: Get adverse events for a drug
      description: |
        Get adverse event data for a specific drug, including:
        - FDA Adverse Event Reporting System (FAERS) data
        - Clinical trial adverse events
        - Post-market surveillance reports
        - Severity classifications and frequencies
      operationId: get_drug_adverse_events
      parameters:
        - name: drug_id
          in: path
          required: true
          description: Unique identifier for the drug
          schema:
            type: string
            format: uuid
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page
          required: false
          schema:
            type: integer
            default: 50
            minimum: 1
            maximum: 200
        - name: severity
          in: query
          description: Filter by adverse event severity
          required: false
          schema:
            type: array
            items:
              $ref: '#/components/schemas/AdverseEventSeverity'
        - name: system_organ_class
          in: query
          description: Filter by system organ class (MedDRA classification)
          required: false
          schema:
            type: string
        - name: preferred_term
          in: query
          description: Search by MedDRA preferred term
          required: false
          schema:
            type: string
        - name: date_from
          in: query
          description: Start date for adverse event reports (ISO 8601)
          required: false
          schema:
            type: string
            format: date
        - name: date_to
          in: query
          description: End date for adverse event reports (ISO 8601)
          required: false
          schema:
            type: string
            format: date
        - name: source
          in: query
          description: Filter by data source
          required: false
          schema:
            type: array
            items:
              $ref: '#/components/schemas/AdverseEventSource'
        - name: age_group
          in: query
          description: Filter by patient age group
          required: false
          schema:
            $ref: '#/components/schemas/AgeGroup'
        - name: gender
          in: query
          description: Filter by patient gender
          required: false
          schema:
            type: string
            enum: [male, female, unknown]
        - name: outcome
          in: query
          description: Filter by adverse event outcome
          required: false
          schema:
            type: array
            items:
              $ref: '#/components/schemas/AdverseEventOutcome'
      responses:
        '200':
          description: Adverse events retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdverseEventResponse'
        '404':
          description: Drug not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /drugs/new:
    get:
      tags:
        - Drugs
      summary: Get new drug entries
      description: |
        Get recently added drug entries including:
        - New chemical entities (NCEs)
        - New formulations of existing chemicals
        - New routes of administration
        - New dosages for existing drugs
        - New generic versions of existing chemicals
      operationId: get_new_drugs
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page
          required: false
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
        - name: days_back
          in: query
          description: Number of days to look back for new entries
          required: false
          schema:
            type: integer
            default: 30
            minimum: 1
            maximum: 365
        - name: entry_type
          in: query
          description: Filter by type of new drug entry
          required: false
          schema:
            type: array
            items:
              $ref: '#/components/schemas/NewDrugEntryType'
        - name: therapeutic_area
          in: query
          description: Filter by therapeutic area
          required: false
          schema:
            type: string
        - name: company
          in: query
          description: Filter by pharmaceutical company
          required: false
          schema:
            type: string
        - name: approval_status
          in: query
          description: Filter by approval status
          required: false
          schema:
            type: array
            items:
              type: string
              enum: [approved, pending, investigational]
      responses:
        '200':
          description: New drugs retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewDrugListResponse'

  # Clinical Trials
  /clinical-trials:
    get:
      tags:
        - Clinical Trials
      summary: List clinical trials
      description: Get a paginated list of clinical trials with filtering options
      operationId: list_clinical_trials
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page
          required: false
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
        - name: drug_id
          in: query
          description: Filter by drug ID
          required: false
          schema:
            type: string
            format: uuid
        - name: phase
          in: query
          description: Filter by trial phase
          required: false
          schema:
            $ref: '#/components/schemas/TrialPhase'
        - name: status
          in: query
          description: Filter by trial status
          required: false
          schema:
            $ref: '#/components/schemas/TrialStatus'
        - name: sponsor
          in: query
          description: Filter by trial sponsor
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Clinical trials retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClinicalTrialListResponse'

  /clinical-trials/{trial_id}:
    get:
      tags:
        - Clinical Trials
      summary: Get clinical trial details
      description: Get detailed information about a specific clinical trial
      operationId: get_clinical_trial_details
      parameters:
        - name: trial_id
          in: path
          required: true
          description: Unique identifier for the clinical trial
          schema:
            type: string
      responses:
        '200':
          description: Clinical trial details retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClinicalTrialDetails'
        '404':
          description: Clinical trial not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Companies
  /companies:
    get:
      tags:
        - Companies
      summary: List pharmaceutical companies
      description: Get a paginated list of pharmaceutical companies
      operationId: list_companies
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page
          required: false
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
        - name: search
          in: query
          description: Search term for company names
          required: false
          schema:
            type: string
        - name: market_cap_min
          in: query
          description: Minimum market capitalization filter
          required: false
          schema:
            type: number
            format: double
      responses:
        '200':
          description: Companies retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompanyListResponse'

  /companies/{company_id}:
    get:
      tags:
        - Companies
      summary: Get company details
      description: Get detailed information about a specific pharmaceutical company
      operationId: get_company_details
      parameters:
        - name: company_id
          in: path
          required: true
          description: Unique identifier for the company
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Company details retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompanyDetails'
        '404':
          description: Company not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /companies/{company_id}/pipeline:
    get:
      tags:
        - Companies
      summary: Get company drug pipeline
      description: Get the drug development pipeline for a specific company
      operationId: get_company_pipeline
      parameters:
        - name: company_id
          in: path
          required: true
          description: Unique identifier for the company
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Company pipeline retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompanyPipeline'

  # Market Analysis
  /market/therapeutic-areas:
    get:
      tags:
        - Market Analysis
      summary: Get therapeutic areas market data
      description: Get market analysis data for different therapeutic areas
      operationId: get_therapeutic_areas_market
      responses:
        '200':
          description: Therapeutic areas market data retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TherapeuticAreasMarket'

  /market/trends:
    get:
      tags:
        - Market Analysis
      summary: Get market trends
      description: Get current pharmaceutical market trends and insights
      operationId: get_market_trends
      parameters:
        - name: time_period
          in: query
          description: Time period for trend analysis
          required: false
          schema:
            type: string
            enum: [1m, 3m, 6m, 1y, 2y]
            default: 1y
      responses:
        '200':
          description: Market trends retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MarketTrends'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key

  schemas:
    # Common schemas
    ErrorResponse:
      type: object
      required:
        - error
        - message
      properties:
        error:
          type: string
          description: Error code
        message:
          type: string
          description: Human-readable error message
        details:
          type: object
          description: Additional error details

    PaginationMeta:
      type: object
      required:
        - page
        - limit
        - total
        - pages
      properties:
        page:
          type: integer
          description: Current page number
        limit:
          type: integer
          description: Items per page
        total:
          type: integer
          description: Total number of items
        pages:
          type: integer
          description: Total number of pages

    # Health schemas
    HealthStatus:
      type: object
      required:
        - status
        - timestamp
        - version
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        timestamp:
          type: string
          format: date-time
        version:
          type: string
        uptime:
          type: integer
          description: Uptime in seconds
        dependencies:
          type: object
          properties:
            database:
              type: string
              enum: [healthy, unhealthy]
            redis:
              type: string
              enum: [healthy, unhealthy]
            external_apis:
              type: object

    ApiMetrics:
      type: object
      properties:
        requests_total:
          type: integer
        requests_per_minute:
          type: number
        average_response_time:
          type: number
        error_rate:
          type: number

    # Authentication schemas
    LoginRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          format: password

    RefreshTokenRequest:
      type: object
      required:
        - refresh_token
      properties:
        refresh_token:
          type: string

    TokenResponse:
      type: object
      required:
        - access_token
        - token_type
        - expires_in
      properties:
        access_token:
          type: string
        refresh_token:
          type: string
        token_type:
          type: string
          default: bearer
        expires_in:
          type: integer
          description: Token expiration time in seconds

    # User schemas
    UserProfile:
      type: object
      required:
        - id
        - email
        - first_name
        - last_name
        - created_at
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
          format: email
        first_name:
          type: string
        last_name:
          type: string
        organization:
          type: string
        role:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    UserProfileUpdate:
      type: object
      properties:
        first_name:
          type: string
        last_name:
          type: string
        organization:
          type: string

    # Drug schemas
    DrugStatus:
      type: string
      enum:
        - discovery
        - preclinical
        - phase_1
        - phase_2
        - phase_3
        - approved
        - withdrawn
        - discontinued

    NewDrugEntryType:
      type: string
      enum:
        - new_chemical_entity
        - new_formulation
        - new_route
        - new_dosage
        - new_generic
        - new_combination
        - new_indication

    # Adverse Event schemas
    AdverseEventSeverity:
      type: string
      enum:
        - mild
        - moderate
        - severe
        - life_threatening
        - fatal
        - unknown

    AdverseEventSource:
      type: string
      enum:
        - faers
        - clinical_trial
        - post_market_surveillance
        - literature
        - spontaneous_report
        - regulatory_submission
        - other

    AgeGroup:
      type: string
      enum:
        - neonate
        - infant
        - child
        - adolescent
        - adult
        - elderly
        - unknown

    AdverseEventOutcome:
      type: string
      enum:
        - recovered
        - recovering
        - not_recovered
        - fatal
        - life_threatening
        - hospitalization
        - disability
        - congenital_anomaly
        - other
        - unknown

    Drug:
      type: object
      required:
        - id
        - name
        - status
        - therapeutic_area
        - company_id
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        generic_name:
          type: string
        status:
          $ref: '#/components/schemas/DrugStatus'
        therapeutic_area:
          type: string
        indication:
          type: string
        company_id:
          type: string
          format: uuid
        company_name:
          type: string
        approval_date:
          type: string
          format: date
        created_at:
          type: string
          format: date-time

    DrugDetails:
      allOf:
        - $ref: '#/components/schemas/Drug'
        - type: object
          properties:
            description:
              type: string
            mechanism_of_action:
              type: string
            dosage_form:
              type: string
            route_of_administration:
              type: string
            target_population:
              type: string
            market_size:
              type: number
              format: double
            patents:
              type: array
              items:
                $ref: '#/components/schemas/Patent'
            regulatory_status:
              type: object
              properties:
                fda:
                  type: string
                ema:
                  type: string
                other:
                  type: object

    DrugListResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/Drug'
        meta:
          $ref: '#/components/schemas/PaginationMeta'

    NewDrug:
      allOf:
        - $ref: '#/components/schemas/Drug'
        - type: object
          required:
            - entry_type
            - entry_date
            - changes
          properties:
            entry_type:
              $ref: '#/components/schemas/NewDrugEntryType'
            entry_date:
              type: string
              format: date-time
              description: Date when this entry was added to the database
            changes:
              type: object
              description: Details about what changed or was added
              properties:
                description:
                  type: string
                  description: Human-readable description of the changes
                previous_version:
                  type: object
                  description: Previous version details (if applicable)
                  properties:
                    drug_id:
                      type: string
                      format: uuid
                    name:
                      type: string
                    formulation:
                      type: string
                    dosage:
                      type: string
                    route:
                      type: string
                new_attributes:
                  type: object
                  description: New or changed attributes
                  properties:
                    formulation:
                      type: string
                    dosage:
                      type: string
                    route_of_administration:
                      type: string
                    strength:
                      type: string
                    packaging:
                      type: string
                    generic_manufacturer:
                      type: string
                    combination_drugs:
                      type: array
                      items:
                        type: object
                        properties:
                          drug_name:
                            type: string
                          active_ingredient:
                            type: string
                          strength:
                            type: string
            regulatory_info:
              type: object
              description: Regulatory approval information
              properties:
                approval_date:
                  type: string
                  format: date
                approval_authority:
                  type: string
                  enum: [FDA, EMA, PMDA, HC, TGA, ANVISA, NMPA, other]
                application_number:
                  type: string
                approval_type:
                  type: string
                  enum: [new_drug_application, abbreviated_new_drug_application, biologics_license_application, supplemental_application]
                priority_designation:
                  type: array
                  items:
                    type: string
                    enum: [breakthrough_therapy, fast_track, accelerated_approval, priority_review, orphan_drug]
            market_impact:
              type: object
              description: Expected or actual market impact
              properties:
                market_entry_date:
                  type: string
                  format: date
                expected_market_size:
                  type: number
                  format: double
                competition_impact:
                  type: string
                  enum: [first_in_class, best_in_class, me_too, generic_entry]
                pricing_information:
                  type: object
                  properties:
                    launch_price:
                      type: number
                      format: double
                    currency:
                      type: string
                    pricing_strategy:
                      type: string

    NewDrugListResponse:
      type: object
      required:
        - data
        - meta
        - summary
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/NewDrug'
        meta:
          $ref: '#/components/schemas/PaginationMeta'
        summary:
          type: object
          description: Summary statistics for the new drug entries
          properties:
            total_new_entries:
              type: integer
            by_entry_type:
              type: object
              properties:
                new_chemical_entity:
                  type: integer
                new_formulation:
                  type: integer
                new_route:
                  type: integer
                new_dosage:
                  type: integer
                new_generic:
                  type: integer
                new_combination:
                  type: integer
                new_indication:
                  type: integer
            by_therapeutic_area:
              type: object
              additionalProperties:
                type: integer
            by_approval_status:
              type: object
              properties:
                approved:
                  type: integer
                pending:
                  type: integer
                investigational:
                  type: integer
            trending_companies:
              type: array
              items:
                type: object
                properties:
                  company_name:
                    type: string
                  new_entries_count:
                    type: integer

    # Adverse Event data schemas
    AdverseEvent:
      type: object
      required:
        - id
        - drug_id
        - preferred_term
        - severity
        - outcome
        - report_date
        - source
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the adverse event report
        drug_id:
          type: string
          format: uuid
          description: Reference to the drug associated with this adverse event
        case_id:
          type: string
          description: External case identifier (e.g., FAERS case number)
        preferred_term:
          type: string
          description: MedDRA preferred term for the adverse event
        system_organ_class:
          type: string
          description: MedDRA system organ class
        high_level_term:
          type: string
          description: MedDRA high level term
        severity:
          $ref: '#/components/schemas/AdverseEventSeverity'
        outcome:
          $ref: '#/components/schemas/AdverseEventOutcome'
        seriousness:
          type: boolean
          description: Whether the event is considered serious by regulatory criteria
        source:
          $ref: '#/components/schemas/AdverseEventSource'
        report_date:
          type: string
          format: date
          description: Date the adverse event was reported
        event_date:
          type: string
          format: date
          description: Date the adverse event occurred (if known)
        patient_info:
          type: object
          description: Patient demographic information
          properties:
            age:
              type: integer
              minimum: 0
              maximum: 150
            age_group:
              $ref: '#/components/schemas/AgeGroup'
            gender:
              type: string
              enum: [male, female, unknown]
            weight:
              type: number
              format: double
              description: Patient weight in kg
            medical_history:
              type: array
              items:
                type: string
              description: Relevant medical history terms
        drug_info:
          type: object
          description: Information about the drug administration
          properties:
            indication:
              type: string
              description: Indication for which the drug was prescribed
            dosage:
              type: string
              description: Dosage information
            route:
              type: string
              description: Route of administration
            start_date:
              type: string
              format: date
              description: Date drug therapy started
            end_date:
              type: string
              format: date
              description: Date drug therapy ended (if applicable)
            duration_days:
              type: integer
              description: Duration of therapy in days
            rechallenge:
              type: boolean
              description: Whether rechallenge occurred
            dechallenge:
              type: boolean
              description: Whether dechallenge occurred
        concomitant_drugs:
          type: array
          items:
            type: object
            properties:
              drug_name:
                type: string
              indication:
                type: string
              start_date:
                type: string
                format: date
              end_date:
                type: string
                format: date
          description: Other drugs taken concurrently
        reporter_info:
          type: object
          description: Information about the reporter
          properties:
            qualification:
              type: string
              enum: [physician, pharmacist, nurse, consumer, lawyer, other]
            country:
              type: string
              description: Reporter's country
        regulatory_info:
          type: object
          description: Regulatory submission information
          properties:
            submission_date:
              type: string
              format: date
            regulatory_number:
              type: string
            expedited_report:
              type: boolean
            follow_up_number:
              type: integer

    AdverseEventSummary:
      type: object
      description: Statistical summary of adverse events
      properties:
        total_reports:
          type: integer
          description: Total number of adverse event reports
        by_severity:
          type: object
          properties:
            mild:
              type: integer
            moderate:
              type: integer
            severe:
              type: integer
            life_threatening:
              type: integer
            fatal:
              type: integer
            unknown:
              type: integer
        by_outcome:
          type: object
          properties:
            recovered:
              type: integer
            recovering:
              type: integer
            not_recovered:
              type: integer
            fatal:
              type: integer
            life_threatening:
              type: integer
            hospitalization:
              type: integer
            disability:
              type: integer
            congenital_anomaly:
              type: integer
            other:
              type: integer
            unknown:
              type: integer
        by_system_organ_class:
          type: object
          additionalProperties:
            type: integer
          description: Count of events by MedDRA system organ class
        top_preferred_terms:
          type: array
          items:
            type: object
            properties:
              term:
                type: string
              count:
                type: integer
              percentage:
                type: number
                format: double
          description: Most frequently reported adverse events
        by_age_group:
          type: object
          properties:
            neonate:
              type: integer
            infant:
              type: integer
            child:
              type: integer
            adolescent:
              type: integer
            adult:
              type: integer
            elderly:
              type: integer
            unknown:
              type: integer
        by_gender:
          type: object
          properties:
            male:
              type: integer
            female:
              type: integer
            unknown:
              type: integer
        by_source:
          type: object
          properties:
            faers:
              type: integer
            clinical_trial:
              type: integer
            post_market_surveillance:
              type: integer
            literature:
              type: integer
            spontaneous_report:
              type: integer
            regulatory_submission:
              type: integer
            other:
              type: integer
        reporting_trends:
          type: object
          description: Trends in adverse event reporting over time
          properties:
            by_month:
              type: array
              items:
                type: object
                properties:
                  month:
                    type: string
                    format: date
                  count:
                    type: integer
            growth_rate:
              type: number
              format: double
              description: Month-over-month growth rate in reporting

    AdverseEventResponse:
      type: object
      required:
        - data
        - meta
        - summary
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/AdverseEvent'
        meta:
          $ref: '#/components/schemas/PaginationMeta'
        summary:
          $ref: '#/components/schemas/AdverseEventSummary'
        drug_info:
          type: object
          description: Basic information about the drug
          properties:
            id:
              type: string
              format: uuid
            name:
              type: string
            generic_name:
              type: string
            company:
              type: string

    DrugAnalytics:
      type: object
      properties:
        drug_id:
          type: string
          format: uuid
        market_performance:
          type: object
          properties:
            revenue:
              type: number
              format: double
            market_share:
              type: number
              format: double
            growth_rate:
              type: number
              format: double
        clinical_data:
          type: object
          properties:
            active_trials:
              type: integer
            success_rate:
              type: number
              format: double
            patient_population:
              type: integer
        competitive_landscape:
          type: array
          items:
            type: object
            properties:
              competitor_drug:
                type: string
              market_share:
                type: number

    Patent:
      type: object
      properties:
        id:
          type: string
        number:
          type: string
        title:
          type: string
        expiration_date:
          type: string
          format: date
        status:
          type: string

    # Clinical Trial schemas
    TrialPhase:
      type: string
      enum:
        - preclinical
        - phase_1
        - phase_2
        - phase_3
        - phase_4

    TrialStatus:
      type: string
      enum:
        - not_yet_recruiting
        - recruiting
        - active
        - completed
        - terminated
        - withdrawn
        - suspended

    ClinicalTrial:
      type: object
      required:
        - id
        - title
        - phase
        - status
        - sponsor
      properties:
        id:
          type: string
        nct_id:
          type: string
        title:
          type: string
        phase:
          $ref: '#/components/schemas/TrialPhase'
        status:
          $ref: '#/components/schemas/TrialStatus'
        sponsor:
          type: string
        drug_id:
          type: string
          format: uuid
        drug_name:
          type: string
        indication:
          type: string
        enrollment_target:
          type: integer
        enrollment_actual:
          type: integer
        start_date:
          type: string
          format: date
        completion_date:
          type: string
          format: date
        locations:
          type: array
          items:
            type: string

    ClinicalTrialDetails:
      allOf:
        - $ref: '#/components/schemas/ClinicalTrial'
        - type: object
          properties:
            description:
              type: string
            primary_endpoints:
              type: array
              items:
                type: string
            secondary_endpoints:
              type: array
              items:
                type: string
            inclusion_criteria:
              type: array
              items:
                type: string
            exclusion_criteria:
              type: array
              items:
                type: string
            investigators:
              type: array
              items:
                type: object
                properties:
                  name:
                    type: string
                  institution:
                    type: string
            results:
              type: object
              properties:
                primary_outcome:
                  type: object
                adverse_events:
                  type: array
                  items:
                    type: object

    ClinicalTrialListResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/ClinicalTrial'
        meta:
          $ref: '#/components/schemas/PaginationMeta'

    # Company schemas
    Company:
      type: object
      required:
        - id
        - name
        - country
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        ticker:
          type: string
        country:
          type: string
        market_cap:
          type: number
          format: double
        employees:
          type: integer
        founded_year:
          type: integer
        headquarters:
          type: string
        website:
          type: string
          format: uri

    CompanyDetails:
      allOf:
        - $ref: '#/components/schemas/Company'
        - type: object
          properties:
            description:
              type: string
            ceo:
              type: string
            revenue:
              type: number
              format: double
            rd_spending:
              type: number
              format: double
            therapeutic_focus:
              type: array
              items:
                type: string
            recent_approvals:
              type: array
              items:
                $ref: '#/components/schemas/Drug'
            partnerships:
              type: array
              items:
                type: object
                properties:
                  partner_name:
                    type: string
                  deal_value:
                    type: number
                  announcement_date:
                    type: string
                    format: date

    CompanyListResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/Company'
        meta:
          $ref: '#/components/schemas/PaginationMeta'

    CompanyPipeline:
      type: object
      properties:
        company_id:
          type: string
          format: uuid
        company_name:
          type: string
        pipeline_summary:
          type: object
          properties:
            total_drugs:
              type: integer
            by_phase:
              type: object
              properties:
                discovery:
                  type: integer
                preclinical:
                  type: integer
                phase_1:
                  type: integer
                phase_2:
                  type: integer
                phase_3:
                  type: integer
                approved:
                  type: integer
        drugs:
          type: array
          items:
            $ref: '#/components/schemas/Drug'

    # Market Analysis schemas
    TherapeuticAreasMarket:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              therapeutic_area:
                type: string
              market_size:
                type: number
                format: double
              growth_rate:
                type: number
                format: double
              key_players:
                type: array
                items:
                  type: string
              active_drugs:
                type: integer
              pipeline_drugs:
                type: integer

    MarketTrends:
      type: object
      properties:
        period:
          type: string
        overall_growth:
          type: number
          format: double
        trends:
          type: array
          items:
            type: object
            properties:
              trend_name:
                type: string
              description:
                type: string
              impact_score:
                type: number
                format: double
              categories:
                type: array
                items:
                  type: string
        hot_therapeutic_areas:
          type: array
          items:
            type: object
            properties:
              area:
                type: string
              investment:
                type: number
              growth_potential:
                type: number
        emerging_technologies:
          type: array
          items:
            type: object
            properties:
              technology:
                type: string
              adoption_rate:
                type: number
              market_impact:
                type: string
